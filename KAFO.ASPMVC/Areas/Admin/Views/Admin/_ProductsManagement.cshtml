@model ProductsTableVM

<div class="card mb-4" id="products-management">
	<div class="card-header bg-white">
		<div class="d-flex justify-content-between align-items-center">
			<h4 class="mb-0">إدارة المنتجات</h4>
			<a class="btn btn-primary" asp-action="Index" asp-controller="ProductManagement">
				<i class="fas fa-plus"></i> إضافة منتج جديد
			</a>
		</div>
	</div>
	<div class="card-body">
		<div class="table-responsive">
			<table class="table table-hover">


				<thead class="table-light">
					<tr>
						<th class="align-middle">الصورة</th>
						<th class="align-middle">الاسم</th>
						<th class="align-middle">الفئة</th>
						<th class="align-middle">المخزون</th>
						<th class="align-middle">متوسط سعر الشراء</th>
						<th class="align-middle">سعر البيع</th>
						<th class="align-middle">الحالة</th>
						<th class="align-middle">الإجراءات</th>
					</tr>
				</thead>
				<tbody>
					@foreach (ProductVM product in Model.Products)
					{
						<tr>
							<td class="align-middle">
								@if (!string.IsNullOrEmpty(product.ImageUrl))
								{
									<img src="@product.ImageUrl" alt="@product.Name" class="img-thumbnail mx-auto" style="width: 60px; height: 60px; object-fit: cover;" />
								}
								else
								{
									<div class="no-image-placeholder mx-auto" style="width: 60px; height: 60px; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center;">
										<i class="fas fa-box-open text-muted"></i>
									</div>
								}
							</td>
							<td class="align-middle">@product.Name</td>
							<td class="align-middle">@product.Category?.Name</td>
							<td class="align-middle">
								<span class="@(product.StockQuantity <= 0 ? "text-danger fw-bold" : (product.StockQuantity < 10 ? "text-secondary" : "text-primary"))">
									@product.StockQuantity.ToString("N0")
								</span>

							</td>

							<td class="align-middle currency-egp">@product.AveragePurchasePrice.ToString("N2")</td>
							<td class="align-middle currency-egp">@product.SellingPrice.ToString("N2")</td>
							<td class="align-middle">
								<span class="badge @(product.IsActive ? "bg-success" : "bg-secondary")">
									@(product.IsActive ? "نشط" : "غير نشط")
								</span>
							</td>
							<td class="align-middle">
								<div class="d-flex justify-content-center">
									<div class="btn-group btn-group-sm" role="group">
										<a href="@Url.Action("Details", new { id = product.Id })" class="btn btn-info" title="عرض">
											<i class="fas fa-eye"></i>
										</a>
										<a asp-controller="ProductManagement" asp-action="Edit" asp-route-Id="@product.Id" class="btn btn-warning" title="تعديل">
											<i class="fas fa-edit"></i>
										</a>
										<a href="@Url.Action("Delete", new { id = product.Id })" class="btn btn-danger" title="حذف">
											<i class="fas fa-trash-alt"></i>
										</a>
									</div>
								</div>
							</td>
						</tr>
					}
				</tbody>
			</table>
		</div>
		<nav>
			<ul class="pagination justify-content-end">
				<li class="page-item @(Model.CurrentProductPage == 1 ? "disabled" : "")">
					<a class="page-link" onclick="loadAdminContent('Products', @Model.CurrentProductPage-1)" tabindex="-1">السابق</a>
				</li>
				@for (int i = 1; i <= Model.TotalProductPages; i++)
				{
					<li class="page-item @(i == Model.CurrentProductPage ? "active" : "")"><a class="page-link" onclick="loadAdminContent('Products', @i)">@i</a></li>
				}
				<li class="page-item @(Model.CurrentProductPage == Model.TotalProductPages ? "disabled" : "")">
					<a class="page-link" onclick="loadAdminContent('Products', @Model.CurrentProductPage+1)">التالي</a>
				</li>
			</ul>
		</nav>
	</div>
</div>

