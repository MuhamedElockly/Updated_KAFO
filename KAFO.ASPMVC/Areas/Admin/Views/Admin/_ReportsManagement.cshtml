@model Kafo.ASPMVC.Models.HomeViewModel

<div class="card mb-4" id="reports-management">
	<div class="card-header bg-white">
		<h4 class="mb-0">التقارير</h4>
	</div>
	<div class="card-body">
		<div class="row mb-4">
			<div class="col-md-12">
				<h5>اختر نوع التقرير:</h5>
				<div class="d-flex flex-wrap gap-2 mb-3">
					<button class="btn btn-info report-type-btn" data-report-type="profit">إجمالي الأرباح</button>
					<button class="btn btn-warning report-type-btn" data-report-type="sales">إجمالي المبيعات</button>
					<button class="btn btn-dark report-type-btn" data-report-type="most_sold">المنتج الأكثر مبيعًا</button>
					<button class="btn btn-success report-type-btn" data-report-type="most_profitable_seller">البائع الأكثر ربحاً</button>
					<button class="btn btn-primary report-type-btn" data-report-type="most_profitable_product">المنتج الأكثر ربحاً</button>
					<button class="btn btn-info report-type-btn" data-report-type="total_payments">عدد المدفوعات الكلي</button>
					<button class="btn btn-secondary report-type-btn" data-report-type="sold_products">المنتجات المباعة</button>
				</div>
			</div>
		</div>

		<div id="report-details-section" style="display:none;">
			<h5 class="mt-4" id="report-title"></h5>
			<div class="row mb-3 align-items-end">
				<div class="col-md-4">
					<label for="reportStartDate" class="form-label">تاريخ البدء</label>
					<input type="date" class="form-control" id="reportStartDate">
				</div>
				<div class="col-md-4">
					<label for="reportEndDate" class="form-label">تاريخ الانتهاء</label>
					<input type="date" class="form-control" id="reportEndDate">
				</div>
				<div class="col-md-2">
					<button class="btn btn-primary w-100" onclick="generateReport()">عرض التقرير</button>
				</div>
			</div>
			<div id="report-results" class="mt-3 p-3 border rounded bg-light">
				<p class="text-muted">الرجاء تحديد نطاق تاريخ لعرض التقرير.</p>
			</div>
		</div>
	</div>
</div>

<!-- Report Actions Template -->
<template id="report-actions-template">
    <div class="report-actions mt-3 d-flex gap-2 justify-content-end">
        <button class="btn btn-primary" onclick="downloadReportAsPDF()">
            <i class="fas fa-download"></i> تحميل PDF
        </button>
        <button class="btn btn-secondary" onclick="printReport()">
            <i class="fas fa-print"></i> طباعة
        </button>
    </div>
</template>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script src="~/js/admin/reports.js" asp-append-version="true"></script>
<script>
    // Initialize report functionality after the view is loaded
    $(document).ready(function() {
        initializeReportFunctionality();
    });
</script> 